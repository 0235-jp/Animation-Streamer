services:
  voicevox:
    image: voicevox/voicevox_engine:cpu-latest
    restart: unless-stopped
    ports:
      - '50021:50021'

  animation-streamer-dev:
    build:
      context: .
      target: dev
    depends_on:
      - voicevox
    volumes:
      - ./src:/app/src
      - ./config:/app/config
      - ./motions:/app/motions:ro
      - ./output:/app/output
    environment:
      - RESPONSE_PATH_BASE=${PWD}/output
    ports:
      - '4000:4000'

  animation-streamer:
    image: ghcr.io/0235-jp/animation-streamer:latest
    restart: unless-stopped
    depends_on:
      - voicevox
    volumes:
      - ./config:/app/config
      - ./motions:/app/motions:ro
      - ./output:/app/output
    environment:
      - RESPONSE_PATH_BASE=${PWD}/output
    ports:
      - '4000:4000'
